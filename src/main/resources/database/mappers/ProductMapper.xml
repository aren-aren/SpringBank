<?xml version="1.0" encoding="UTF-8"?>
		<!DOCTYPE mapper
		    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
		    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.moveone.app.product.ProductDAO">
	<sql id="search">
		<where>
			<if test="kind=='kind1' or kind=='kind3'">
				OR PRODUCTNAME LIKE '%'||#{search}||'%'
			</if>
			<if test="kind=='kind2' or kind=='kind3'">
				OR PRODUCTCONTENTS LIKE '%'||#{search}||'%'
			</if>
		</where>
	</sql>

	<select id="getList" parameterType="Pager" resultType="ProductDTO">
		SELECT PR.PRODUCTNUM, PR.PRODUCTNAME, PR.PRODUCTRATE, PR.PRODUCTJUMSU
		FROM (
			SELECT ROWNUM R, P.PRODUCTNUM, P.PRODUCTNAME, P.PRODUCTRATE, P.PRODUCTJUMSU
			FROM PRODUCT P
			<include refid="search"></include>
			ORDER BY PRODUCTNUM DESC
		) PR
		WHERE PR.R BETWEEN #{startRow} AND #{lastRow}
	</select>
	
	<select id="getDetail" parameterType="ProductDTO" resultType="ProductDTO">
		SELECT * FROM PRODUCT WHERE PRODUCTNUM = #{productNum}
	</select>
	
	<select id="getTotal" resultType="java.lang.Long">
		SELECT COUNT(PRODUCTNUM) FROM PRODUCT <include refid="search"></include>
	</select>
	
	<insert id="addProduct" parameterType="ProductDTO">
		INSERT INTO PRODUCT 
		VALUES (
			PRODUCT_SEQ.NEXTVAL, 
			#{productName}, 
			#{productContents}, 
			#{productRate}, 
			#{productJumsu}
		)
	</insert>
</mapper>